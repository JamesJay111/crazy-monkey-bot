# Twitter æ¨æ–‡æ¨¡æ¿å®ç°æ–‡æ¡£

## ğŸ“‹ å®ç°æ¦‚è¿°

å·²æŒ‰ç…§æ–°è¦æ±‚é‡æ„ Twitter æ¨æ–‡æ¨¡æ¿ï¼Œä¸¥æ ¼éµå¾ªç”¨æˆ·æä¾›çš„æ ¼å¼è§„èŒƒã€‚

## ğŸ¯ æ ¸å¿ƒå˜æ›´

### 1. æ¨¡æ¿æ ¼å¼ï¼ˆä¸¥æ ¼éµå¾ªï¼‰

```
ğŸ“Š åˆçº¦æ•°æ®æ¦‚è§ˆï½œ{TICKER}
Binance Â· 4h

â€”

åˆçº¦æŒä»“ï¼ˆOIï¼‰
æ€»æŒä»“ï¼ˆ4h å‰ï¼‰ï¼š{OI_USD}

èµ„é‡‘è´¹ç‡
Funding Rateï¼š{FUNDING_RATE}

ä¸»åŠ¨æˆäº¤æ–¹å‘
ä¸»åŠ¨ä¹°å…¥ï¼š{TAKER_BUY_USD}
ä¸»åŠ¨å–å‡ºï¼š{TAKER_SELL_USD}

å¤§æˆ·æŒä»“ç»“æ„ï¼ˆæœ€è¿‘ä¸€å‘¨æœŸï¼‰
å¤šå•å æ¯”ï¼š{TOP_LONG_PERCENT}
ç©ºå•å æ¯”ï¼š{TOP_SHORT_PERCENT}
å¤šç©ºæ¯”ï¼š{TOP_LONG_SHORT_RATIO}

æ•°æ®è¯´æ˜
ä»¥ä¸Šæ•°æ®åŸºäº â‰¥4h ç²’åº¦çš„åˆçº¦å¸‚åœºç»Ÿè®¡

â€”

ç»“æ„åˆ†æï½œ{TICKER} åˆçº¦ï¼ˆ4hï¼‰

{DEEPSEEK_ANALYSIS_BLOCK}

â€”

ç»“æ„æ€§é£é™©è§‚å¯Ÿ

{RISK_BLOCK}

âš ï¸ æœ¬å†…å®¹ä¸ºç»“æ„è§‚å¯Ÿï¼Œä¸æ„æˆæŠ•èµ„æˆ–äº¤æ˜“å»ºè®®ã€‚
```

### 2. DeepSeek èŒè´£ï¼ˆä¸¥æ ¼é™åˆ¶ï¼‰

DeepSeek åªè´Ÿè´£ç”Ÿæˆä»¥ä¸‹ä¸¤å—å†…å®¹ï¼š

#### {DEEPSEEK_ANALYSIS_BLOCK} - åˆçº¦ç»“æ„åˆ†æ
- âœ… ä¸é‡å¤åŸºç¡€æ•°æ®
- âœ… ä¸ç”Ÿæˆä»»ä½•æ•°å€¼
- âœ… ä¸ç»™äº¤æ˜“å»ºè®®
- âœ… åªæè¿°ç»“æ„æ€§ç‰¹å¾

#### {RISK_BLOCK} - ç»“æ„æ€§é£é™©è§‚å¯Ÿ
- âœ… åªè®¨è®ºç»“æ„é”™é…/è„†å¼±æ€§
- âœ… ä¸æ¶‰åŠä»·æ ¼é¢„æµ‹
- âœ… ä¸åŒ…å«æ•°å€¼

### 3. ç¦æ­¢äº‹é¡¹ï¼ˆä¸¥æ ¼æ ¡éªŒï¼‰

DeepSeek è¾“å‡ºä¸­ä¸å¾—åŒ…å«ï¼š
- âŒ æ•°å€¼ï¼ˆ$ã€%ã€å…·ä½“æ•°å­—ï¼‰
- âŒ åšå¤š/åšç©º/ä¹°å–/é¢„æµ‹/å»ºè®®
- âŒ Markdown æ ‡é¢˜
- âŒ å…è´£å£°æ˜ï¼ˆæ¨¡æ¿å·²æœ‰ï¼‰

å¦‚æœè¿å â†’ ä½¿ç”¨ fallback åˆ†ææ–‡æœ¬

## ğŸ“ ä¿®æ”¹æ–‡ä»¶

### ä¸»è¦ä¿®æ”¹
- `src/services/tweetContent.service.ts` - å®Œå…¨é‡æ„ Twitter æ¨¡æ¿ç”Ÿæˆé€»è¾‘

### å…³é”®æ–¹æ³•

1. **`generateTweet()`** - ä¸»å…¥å£ï¼Œç”Ÿæˆå®Œæ•´æ¨æ–‡
   - è°ƒç”¨ `generateTwitterBaseData()` ç”ŸæˆåŸºç¡€æ•°æ®
   - è°ƒç”¨ `generateTwitterDeepSeekAnalysis()` ç”Ÿæˆ DeepSeek åˆ†æ
   - ä¸¥æ ¼æŒ‰ç…§æ¨¡æ¿æ ¼å¼æ‹¼æ¥

2. **`generateTwitterBaseData()`** - ç”ŸæˆåŸºç¡€æ•°æ®éƒ¨åˆ†
   - ä¸¥æ ¼æŒ‰ç…§æ–°æ¨¡æ¿æ ¼å¼
   - æ‰€æœ‰å­—æ®µç”±ä»£ç å¡«å……
   - ä¸å…è®¸å‡ºç° `-` / `â€”` / `undefined`

3. **`generateTwitterDeepSeekAnalysis()`** - ç”Ÿæˆ DeepSeek åˆ†æ
   - åˆ†åˆ«è°ƒç”¨ `generateStructureAnalysis()` å’Œ `generateRiskObservation()`
   - è¿”å› `{ analysisBlock, riskBlock }`

4. **`generateStructureAnalysis()`** - ç”Ÿæˆç»“æ„åˆ†æ
   - ä½¿ç”¨ä¸¥æ ¼çš„ System Prompt
   - ç¦æ­¢ç”Ÿæˆæ•°å€¼å’Œäº¤æ˜“å»ºè®®
   - åªæè¿°ç»“æ„æ€§ç‰¹å¾

5. **`generateRiskObservation()`** - ç”Ÿæˆé£é™©è§‚å¯Ÿ
   - åªè®¨è®ºç»“æ„é”™é…/è„†å¼±æ€§
   - ä¸æ¶‰åŠä»·æ ¼é¢„æµ‹

6. **`validateAndCleanDeepSeekOutput()`** - éªŒè¯å¹¶æ¸…ç†è¾“å‡º
   - æ£€æŸ¥ç¦æ­¢è¯
   - æ£€æŸ¥æ•°å€¼
   - ç§»é™¤ Markdown æ ‡é¢˜
   - å¦‚æœè¿åè§„åˆ™ï¼Œä½¿ç”¨ fallback

## ğŸ”§ å®ç°ç»†èŠ‚

### DeepSeek Promptï¼ˆç»“æ„åˆ†æï¼‰

```
System Prompt:
ä½ æ˜¯ä¸“ä¸šåˆçº¦å¸‚åœºç»“æ„åˆ†æå¸ˆã€‚æ ¹æ®æä¾›çš„åˆçº¦æ•°æ®ï¼Œç”Ÿæˆç»“æ„åˆ†æã€‚

**ä¸¥æ ¼çº¦æŸ**ï¼š
1. åªæè¿°ç»“æ„æ€§ç‰¹å¾ï¼šä»“ä½ç»“æ„ã€èµ„é‡‘è´¹ç‡è¶‹åŠ¿ã€ä¸»åŠ¨æˆäº¤æ–¹å‘ã€ç»“æ„ä¸€è‡´æ€§
2. ç»å¯¹ç¦æ­¢åŒ…å«ï¼šæ•°å€¼ï¼ˆ$ã€%ã€å…·ä½“æ•°å­—ï¼‰ã€åšå¤š/åšç©º/ä¹°å–/é¢„æµ‹/å»ºè®®ã€Markdown æ ‡é¢˜ã€å…è´£å£°æ˜
3. ä¸é‡å¤åŸºç¡€æ•°æ®ï¼ˆåŸºç¡€æ•°æ®å·²åœ¨æ¨æ–‡å‰åŠéƒ¨åˆ†å±•ç¤ºï¼‰
4. ç”¨ç®€ä½“ä¸­æ–‡è¾“å‡ºï¼Œè¯­æ°”å®¢è§‚ä¸“ä¸š
5. è‹¥æ•°æ®ä¸è¶³ï¼Œç”¨éæŠ€æœ¯å£å»è¯´æ˜ï¼Œä¸è¦æåŠ"API/é™æµ/æ•°æ®ä¸è¶³"ç­‰æŠ€æœ¯è¯æ±‡

**è¾“å‡ºè¦æ±‚**ï¼š
åªè¾“å‡ºç»“æ„åˆ†ææ–‡æœ¬ï¼Œä¸è¦åŒ…å«æ ‡é¢˜ã€åˆ†ç‚¹ç¬¦å·ã€æ•°å€¼ã€‚
```

### DeepSeek Promptï¼ˆé£é™©è§‚å¯Ÿï¼‰

```
System Prompt:
ä½ æ˜¯ä¸“ä¸šåˆçº¦å¸‚åœºç»“æ„åˆ†æå¸ˆã€‚æ ¹æ®æä¾›çš„åˆçº¦æ•°æ®ï¼Œç”Ÿæˆç»“æ„æ€§é£é™©è§‚å¯Ÿã€‚

**ä¸¥æ ¼çº¦æŸ**ï¼š
1. åªè®¨è®ºç»“æ„é”™é…/è„†å¼±æ€§ï¼Œä¸æ¶‰åŠä»·æ ¼é¢„æµ‹
2. ç»å¯¹ç¦æ­¢åŒ…å«ï¼šæ•°å€¼ï¼ˆ$ã€%ã€å…·ä½“æ•°å­—ï¼‰ã€åšå¤š/åšç©º/ä¹°å–/é¢„æµ‹/å»ºè®®ã€Markdown æ ‡é¢˜ã€å…è´£å£°æ˜
3. ç”¨ç®€ä½“ä¸­æ–‡è¾“å‡ºï¼Œè¯­æ°”å®¢è§‚ä¸“ä¸š
4. è‹¥æ•°æ®ä¸è¶³ï¼Œç”¨éæŠ€æœ¯å£å»è¯´æ˜

**è¾“å‡ºè¦æ±‚**ï¼š
åªè¾“å‡ºé£é™©è§‚å¯Ÿæ–‡æœ¬ï¼Œä¸è¦åŒ…å«æ ‡é¢˜ã€åˆ†ç‚¹ç¬¦å·ã€æ•°å€¼ã€‚
```

### æ•°æ®ä¼ é€’ç­–ç•¥

ä¸ºäº†é¿å… DeepSeek ç”Ÿæˆæ•°å€¼ï¼Œæˆ‘ä»¬åªä¼ é€’**å®šæ€§æè¿°**ï¼š

```typescript
// ä¸ä¼ é€’å…·ä½“æ•°å€¼ï¼Œåªä¼ é€’å®šæ€§æè¿°
const topBias = snapshot.topAccountLongShortRatio > 1.1 ? 'åå¤š' : 
                snapshot.topAccountLongShortRatio < 0.9 ? 'åç©º' : 'ä¸­æ€§';
const fundingBias = snapshot.fundingRate > 0.01 ? 'å¤šå¤´æ”¯ä»˜è´¹ç”¨' : 
                    snapshot.fundingRate < -0.01 ? 'ç©ºå¤´æ”¯ä»˜è´¹ç”¨' : 'ç›¸å¯¹å‡è¡¡';
```

### Fallback æœºåˆ¶

å¦‚æœ DeepSeek è¾“å‡ºè¿åè§„åˆ™ï¼Œä½¿ç”¨ fallbackï¼š

```typescript
// ç»“æ„åˆ†æ fallback
'å½“å‰åˆçº¦ç»“æ„æ˜¾ç¤ºæŒä»“åˆ†å¸ƒä¸èµ„é‡‘è´¹ç‡å­˜åœ¨ä¸€å®šå…³è”æ€§ï¼Œä¸»åŠ¨æˆäº¤æ–¹å‘ä¸å¤§æˆ·æŒä»“ç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œæ•´ä½“ç»“æ„ç›¸å¯¹ç¨³å®šã€‚'

// é£é™©è§‚å¯Ÿ fallback
'å½“å‰ç»“æ„å­˜åœ¨ä¸€å®šè„†å¼±æ€§ï¼Œéœ€æŒç»­è§‚å¯Ÿç»“æ„å˜åŒ–ã€‚èµ„é‡‘è´¹ç‡ä¸æŒä»“ç»“æ„çš„åŒ¹é…åº¦å½±å“æ•´ä½“ç¨³å®šæ€§ã€‚'
```

## âœ… éªŒè¯è§„åˆ™

### 1. æ¨¡æ¿æ ¼å¼éªŒè¯
- âœ… åŸºç¡€æ•°æ®éƒ¨åˆ†ä¸¥æ ¼æŒ‰ç…§æ¨¡æ¿æ ¼å¼
- âœ… æ‰€æœ‰å­—æ®µç”±ä»£ç å¡«å……ï¼Œä¸å‡ºç° `-` / `â€”` / `undefined`
- âœ… é—´éš”ç¬¦ `â€”` æ­£ç¡®ä½¿ç”¨
- âœ… æœ€åæœ‰å…è´£å£°æ˜

### 2. DeepSeek è¾“å‡ºéªŒè¯
- âœ… æ£€æŸ¥ç¦æ­¢è¯ï¼ˆåšå¤šã€åšç©ºã€ä¹°å…¥ã€å–å‡ºç­‰ï¼‰
- âœ… æ£€æŸ¥æ•°å€¼ï¼ˆ$ã€%ã€æ•°å­—ï¼‰
- âœ… ç§»é™¤ Markdown æ ‡é¢˜
- âœ… å¦‚æœè¿åï¼Œä½¿ç”¨ fallback

### 3. æ•°æ®å®Œæ•´æ€§éªŒè¯
- âœ… é€šè¿‡ `SnapshotValidator` æ ¡éªŒ
- âœ… ä»»ä¸€å…³é”®å­—æ®µç¼ºå¤± â†’ æ•´æ¡æ¨æ–‡ä¸å‘é€
- âœ… ä¸å…è®¸å‡ºç° `-` / `â€”` / `undefined`

## ğŸ”„ ä¿æŒä¸å˜çš„åŠŸèƒ½

ä»¥ä¸‹åŠŸèƒ½ä¿æŒä¸å˜ï¼Œæœªä¿®æ”¹ï¼š

1. âœ… **è§¦å‘é€»è¾‘**ï¼šFunding <= -0.05% è§¦å‘
2. âœ… **æ¯æ—¥é™é¢**ï¼šæ¯å¤©æœ€å¤š 3 æ¡
3. âœ… **è½®è¯¢æœºåˆ¶**ï¼šæ¯ 5 åˆ†é’Ÿè½®è¯¢ï¼ˆå¯é…ç½®ï¼‰
4. âœ… **Preflight æ¨¡å¼**ï¼š`PREFLIGHT_MODE=true` æ—¶åªå†™æ—¥å¿—
5. âœ… **æ•°æ®å®Œæ•´æ€§æ ¡éªŒ**ï¼š`SnapshotValidator` ç»§ç»­ç”Ÿæ•ˆ
6. âœ… **å»é‡æœºåˆ¶**ï¼š48h å»é‡ç»§ç»­ç”Ÿæ•ˆ
7. âœ… **TG Bot**ï¼šå®Œå…¨æœªä¿®æ”¹ï¼Œä¸å—å½±å“

## ğŸ“Š ç¤ºä¾‹è¾“å‡º

### è´¦æˆ· Aï¼ˆä¸­æ–‡ï¼‰

```
ğŸ“Š åˆçº¦æ•°æ®æ¦‚è§ˆï½œBTCUSDT
Binance Â· 4h

â€”

åˆçº¦æŒä»“ï¼ˆOIï¼‰
æ€»æŒä»“ï¼ˆ4h å‰ï¼‰ï¼š$1,234.56M

èµ„é‡‘è´¹ç‡
Funding Rateï¼š-0.05%

ä¸»åŠ¨æˆäº¤æ–¹å‘
ä¸»åŠ¨ä¹°å…¥ï¼š$123.45M
ä¸»åŠ¨å–å‡ºï¼š$98.76M

å¤§æˆ·æŒä»“ç»“æ„ï¼ˆæœ€è¿‘ä¸€å‘¨æœŸï¼‰
å¤šå•å æ¯”ï¼š55.00%
ç©ºå•å æ¯”ï¼š45.00%
å¤šç©ºæ¯”ï¼š1.22

æ•°æ®è¯´æ˜
ä»¥ä¸Šæ•°æ®åŸºäº â‰¥4h ç²’åº¦çš„åˆçº¦å¸‚åœºç»Ÿè®¡

â€”

ç»“æ„åˆ†æï½œBTCUSDT åˆçº¦ï¼ˆ4hï¼‰

å½“å‰åˆçº¦ç»“æ„æ˜¾ç¤ºå¤§æˆ·æŒä»“åå¤šï¼Œèµ„é‡‘è´¹ç‡ç©ºå¤´æ”¯ä»˜è´¹ç”¨ï¼Œä¸»åŠ¨æˆäº¤æ–¹å‘åå¤šã€‚æ•´ä½“ç»“æ„ä¸€è‡´ï¼Œå¸‚åœºæƒ…ç»ªç›¸å¯¹ç»Ÿä¸€ã€‚

â€”

ç»“æ„æ€§é£é™©è§‚å¯Ÿ

å½“å‰ç»“æ„ç›¸å¯¹ä¸€è‡´ï¼Œä½†èµ„é‡‘è´¹ç‡çŠ¶æ€æ˜¾ç¤ºå¸‚åœºå­˜åœ¨ä¸€å®šæ‹¥æŒ¤ã€‚éœ€å…³æ³¨ç»“æ„å˜åŒ–ï¼Œé¿å…è¿‡åº¦æ‹¥æŒ¤å¯¼è‡´çš„ç»“æ„æ€§é£é™©ã€‚

âš ï¸ æœ¬å†…å®¹ä¸ºç»“æ„è§‚å¯Ÿï¼Œä¸æ„æˆæŠ•èµ„æˆ–äº¤æ˜“å»ºè®®ã€‚
```

### è´¦æˆ· Bï¼ˆè‹±æ–‡ï¼‰

é€šè¿‡è½¬å‘åŠŸèƒ½è‡ªåŠ¨ç¿»è¯‘ï¼ˆè§ `TWEET_FORWARD_IMPLEMENTATION.md`ï¼‰

### è´¦æˆ· Cï¼ˆéŸ©æ–‡ï¼‰

é€šè¿‡è½¬å‘åŠŸèƒ½è‡ªåŠ¨ç¿»è¯‘ï¼ˆè§ `TWEET_FORWARD_IMPLEMENTATION.md`ï¼‰

## ğŸš€ ä½¿ç”¨è¯´æ˜

### 1. ç¯å¢ƒå˜é‡

æ— éœ€æ–°å¢ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ç°æœ‰é…ç½®ï¼š
- `PREFLIGHT_MODE` - é¢„å‘å¸ƒæ¨¡å¼
- `FUNDING_THRESHOLD_DECIMAL` - èµ„é‡‘è´¹ç‡é˜ˆå€¼ï¼ˆ-0.0005ï¼‰
- `DAILY_TWEET_LIMIT` - æ¯æ—¥é™é¢ï¼ˆ3ï¼‰
- `POLL_INTERVAL_MS` - è½®è¯¢é—´éš”ï¼ˆ300000 = 5åˆ†é’Ÿï¼‰

### 2. å¯åŠ¨

```bash
npm start
```

Twitter è‡ªåŠ¨å‘æ¨ Job ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œä½¿ç”¨æ–°æ¨¡æ¿æ ¼å¼ã€‚

### 3. æµ‹è¯•

ä½¿ç”¨ Preflight æ¨¡å¼æµ‹è¯•ï¼š

```bash
# è®¾ç½® PREFLIGHT_MODE=true
# æŸ¥çœ‹ ./logs/twitter_preflight.log
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **TG Bot æœªä¿®æ”¹**ï¼šTwitter æ¨¡æ¿åªç”¨äº Twitter æ¨æ–‡ï¼Œä¸å½±å“ TG Bot
2. **DeepSeek é™åˆ¶**ï¼šDeepSeek åªç”Ÿæˆç»“æ„åˆ†æå’Œé£é™©è§‚å¯Ÿï¼Œä¸ç”Ÿæˆæ•°å€¼
3. **æ•°æ®å®Œæ•´æ€§**ï¼šä»»ä¸€å…³é”®å­—æ®µç¼ºå¤±ï¼Œæ•´æ¡æ¨æ–‡ä¸å‘é€
4. **æ ¼å¼ä¸¥æ ¼**ï¼šæ¨¡æ¿æ ¼å¼å¿…é¡»ä¸¥æ ¼éµå¾ªï¼Œä¸å…è®¸ä¿®æ”¹

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **å¤šè¯­è¨€æ”¯æŒ**ï¼šå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä¸ºè´¦æˆ· B/C ç”Ÿæˆè‹±æ–‡/éŸ©æ–‡ç‰ˆæœ¬çš„æ¨¡æ¿
2. **æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶**ï¼šå¯ä»¥æ·»åŠ æ¨¡æ¿ç‰ˆæœ¬å·ï¼Œä¾¿äºåç»­è¿­ä»£
3. **A/B æµ‹è¯•**ï¼šå¯ä»¥æµ‹è¯•ä¸åŒæ¨¡æ¿æ ¼å¼çš„æ•ˆæœ



