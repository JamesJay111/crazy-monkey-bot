# èµ„é‡‘è´¹ç‡åŠŸèƒ½ä¿®å¤æ€»ç»“

## ğŸ” é—®é¢˜æ’æŸ¥

### å‘ç°çš„é—®é¢˜

1. **API ç«¯ç‚¹è·¯å¾„é”™è¯¯**
   - âŒ é”™è¯¯è·¯å¾„ï¼š`/api/futures/fundingRate/exchange-list`ï¼ˆé©¼å³°å‘½åï¼‰
   - âœ… æ­£ç¡®è·¯å¾„ï¼š`/api/futures/funding-rate/exchange-list`ï¼ˆè¿å­—ç¬¦ï¼‰

2. **æ•°æ®ç»“æ„è§£æé”™è¯¯**
   - å®é™…è¿”å›æ ¼å¼ï¼šæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ åŒ…å« `{ symbol, stablecoin_margin_list[], token_margin_list[] }`
   - ä¹‹å‰ä»£ç å‡è®¾ï¼šç›´æ¥æ˜¯æ‰å¹³æ•°ç»„æˆ–å¯¹è±¡

### å®é™… API å“åº”ç»“æ„

```json
[
  {
    "symbol": "BTC",
    "stablecoin_margin_list": [
      {
        "exchange": "Binance",
        "funding_rate": -0.000996,
        "funding_rate_interval": 8,
        "next_funding_time": 1766073600000
      },
      ...
    ],
    "token_margin_list": [
      {
        "exchange": "Binance",
        "funding_rate": 0.005038,
        "funding_rate_interval": 8,
        "next_funding_time": 1766073600000
      },
      ...
    ]
  },
  ...
]
```

---

## âœ… å·²ä¿®å¤çš„å†…å®¹

### 1. API ç«¯ç‚¹è·¯å¾„

**ä¿®å¤çš„æ–‡ä»¶**ï¼š`src/clients/coinglass.client.ts`

- âœ… `/api/futures/funding-rate/exchange-list`ï¼ˆå¸ç§èµ„é‡‘è´¹ç‡ï¼‰
- âœ… `/api/futures/funding-rate/ohlc-history`ï¼ˆèµ„é‡‘è´¹ç‡å†å²ï¼‰
- âœ… `/api/futures/funding-rate/accumulated-exchange-list`ï¼ˆç´¯è®¡èµ„é‡‘è´¹ç‡ï¼‰
- âœ… `/api/futures/funding-rate/vol-weight-ohlc-history`ï¼ˆæˆäº¤é‡åŠ æƒèµ„é‡‘è´¹ç‡å†å²ï¼‰

### 2. æ•°æ®è§£æé€»è¾‘

**ä¿®å¤çš„æ–‡ä»¶**ï¼š`src/services/funding.service.ts`

**ä¿®å¤å‰**ï¼š
- å‡è®¾æ•°æ®æ˜¯æ‰å¹³æ•°ç»„æˆ–å¯¹è±¡
- ç›´æ¥è®¿é—® `item.symbol` å’Œ `item.exchange`

**ä¿®å¤å**ï¼š
- éå†æ•°ç»„ï¼Œå¤„ç†æ¯ä¸ª `symbolData`
- åˆ†åˆ«å¤„ç† `stablecoin_margin_list` å’Œ `token_margin_list`
- å±•å¹³æ‰€æœ‰äº¤æ˜“æ‰€æ•°æ®
- å»é‡ï¼šåŒä¸€ symbol åªä¿ç•™ä¼˜å…ˆçº§æœ€é«˜çš„äº¤æ˜“æ‰€

### 3. æ•°æ®å­—æ®µæ˜ å°„

**å¸ç§èµ„é‡‘è´¹ç‡**ï¼š
- `funding_rate` â†’ `fundingRate`ï¼ˆnumberï¼‰
- `next_funding_time` â†’ `nextFundingTime`ï¼ˆtimestampï¼‰

**ç´¯è®¡èµ„é‡‘è´¹ç‡**ï¼š
- `accumulated_funding_rate` â†’ `accumulatedFundingRate`ï¼ˆnumberï¼‰
- `next_funding_time` â†’ `nextFundingTime`ï¼ˆtimestampï¼‰

---

## ğŸ“‹ éœ€è¦çš„ API ä¿¡æ¯ï¼ˆå¦‚æœè¿˜æœ‰é—®é¢˜ï¼‰

å¦‚æœèµ„é‡‘è´¹ç‡åŠŸèƒ½ä»æœ‰é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

### 1. ç´¯è®¡èµ„é‡‘è´¹ç‡ç«¯ç‚¹

**é—®é¢˜**ï¼šç´¯è®¡èµ„é‡‘è´¹ç‡ç«¯ç‚¹å¯èƒ½ä¸å­˜åœ¨æˆ–è·¯å¾„ä¸åŒ

**éœ€è¦ç¡®è®¤**ï¼š
- ç«¯ç‚¹è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼š`/api/futures/funding-rate/accumulated-exchange-list`
- å¦‚æœä¸å­˜åœ¨ï¼Œæ˜¯å¦æœ‰æ›¿ä»£ç«¯ç‚¹ï¼Ÿ
- è¿”å›çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ

**æµ‹è¯•å‘½ä»¤**ï¼š
```bash
curl --request GET \
  --url https://open-api-v4.coinglass.com/api/futures/funding-rate/accumulated-exchange-list \
  --header 'CG-API-KEY: your_api_key' \
  --header 'accept: application/json'
```

### 2. æˆäº¤é‡åŠ æƒèµ„é‡‘è´¹ç‡å†å²

**é—®é¢˜**ï¼šç«¯ç‚¹è·¯å¾„å¯èƒ½ä¸æ­£ç¡®

**éœ€è¦ç¡®è®¤**ï¼š
- ç«¯ç‚¹è·¯å¾„ï¼š`/api/futures/funding-rate/vol-weight-ohlc-history`
- è¿”å›çš„æ•°æ®ç»“æ„
- æ˜¯å¦éœ€è¦ç‰¹æ®Šå‚æ•°

### 3. å…¶ä»–å¯èƒ½çš„é—®é¢˜

å¦‚æœä¿®å¤åä»æœ‰é—®é¢˜ï¼Œè¯·æä¾›ï¼š
- å…·ä½“çš„é”™è¯¯æ¶ˆæ¯
- é”™è¯¯å‘ç”Ÿæ—¶çš„æ“ä½œæ­¥éª¤
- CoinGlass API æ–‡æ¡£é“¾æ¥ï¼ˆå¦‚æœæœ‰ï¼‰

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•æ­¥éª¤

1. **å¸ç§èµ„é‡‘è´¹ç‡ï¼ˆæ­£å‘ï¼‰**
   ```
   /funding
   â†’ é€‰æ‹©ã€Œå¸ç§èµ„é‡‘è´¹ç‡ï¼ˆäº¤æ˜“æ‰€å®æ—¶ï¼‰ã€
   â†’ é€‰æ‹©ã€Œæ­£èµ„é‡‘è´¹ç‡æœ€é«˜ã€
   â†’ åº”è¯¥æ˜¾ç¤º Top 10 åˆ—è¡¨
   ```

2. **å¸ç§èµ„é‡‘è´¹ç‡ï¼ˆè´Ÿå‘ï¼‰**
   ```
   /funding
   â†’ é€‰æ‹©ã€Œå¸ç§èµ„é‡‘è´¹ç‡ï¼ˆäº¤æ˜“æ‰€å®æ—¶ï¼‰ã€
   â†’ é€‰æ‹©ã€Œè´Ÿèµ„é‡‘è´¹ç‡æœ€ä½ã€
   â†’ åº”è¯¥æ˜¾ç¤º Top 10 åˆ—è¡¨
   ```

3. **ç´¯è®¡èµ„é‡‘è´¹ç‡**
   ```
   /funding
   â†’ é€‰æ‹©ã€Œç´¯è®¡èµ„é‡‘è´¹ç‡ï¼ˆäº¤æ˜“æ‰€ï¼‰ã€
   â†’ é€‰æ‹©æ–¹å‘
   â†’ æŸ¥çœ‹ç»“æœ
   ```

### é¢„æœŸç»“æœ

- âœ… æ˜¾ç¤º Top 10 åˆ—è¡¨
- âœ… æ¯ä¸ªé¡¹ç›®åŒ…å«ï¼šsymbol | funding_rate% | exchange | ä¸‹æ¬¡ç»“ç®—æ—¶é—´
- âœ… æ•°æ®æ¥æºï¼šCoinGlass API

---

## ğŸ”§ å¦‚æœä»æœ‰é—®é¢˜

### éœ€è¦çš„ä¿¡æ¯

1. **API æ–‡æ¡£é“¾æ¥**
   - CoinGlass v4 API æ–‡æ¡£ä¸­å…³äºèµ„é‡‘è´¹ç‡çš„ç« èŠ‚
   - ç‰¹åˆ«æ˜¯ `exchange-list` å’Œ `accumulated-exchange-list` çš„è¯´æ˜

2. **å®é™… API å“åº”**
   - ä½¿ç”¨ curl æˆ– Postman æµ‹è¯•å®é™…è¿”å›çš„æ•°æ®
   - æä¾›å®Œæ•´çš„ JSON å“åº”ç¤ºä¾‹

3. **é”™è¯¯æ—¥å¿—**
   - Bot æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
   - åŒ…å« traceIdï¼ˆå¦‚æœæœ‰ï¼‰

### ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

å¦‚æœç´¯è®¡èµ„é‡‘è´¹ç‡ç«¯ç‚¹ä¸å­˜åœ¨ï¼š
- å¯ä»¥æš‚æ—¶éšè—è¯¥é€‰é¡¹
- æˆ–ä½¿ç”¨æ™®é€šèµ„é‡‘è´¹ç‡æ•°æ®è®¡ç®—ç´¯è®¡å€¼ï¼ˆéœ€è¦å†å²æ•°æ®ï¼‰

---

**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2024  
**çŠ¶æ€**ï¼šâœ… ç«¯ç‚¹è·¯å¾„å·²ä¿®å¤ï¼Œæ•°æ®è§£æé€»è¾‘å·²æ›´æ–°

